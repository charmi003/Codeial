for(var perfEntries=performance.getEntriesByType("navigation"),i=0;i<perfEntries.length;i++)"back_forward"===perfEntries[i].type&&$("body").html(localStorage.content);let createPost=function(){let e=$("#new-post-form");e.submit((function(t){t.preventDefault(),$.ajax({method:"post",url:"/posts/create",data:e.serialize(),success:function(e){let t=addPostToDom(e.post);$("#posts-container").prepend(t),deletePost($(" a[href^='/posts/destroy']",t)),toggleLike($(" .like",t)),createComment(),localStorage.content=$("body").html(),displayFlashMessage(e.flash.success)},error:function(e){console.log(e.responseText)}}),$(this).trigger("reset")}))};createPost();let addPostToDom=function(e){return $(`<div class="post-box" id=${e._id}>\n\n    <p>${e.Content}</p>\n    <small>${e.User.Name}</small><br><br>\n\n    <div class="like-info">\n        <a href="/likes/toggle/?p_id=${e._id}&p_type=Post">\n            <i class="far fa-heart like"></i>\n        </a>\n        <span><span class="like-count">${e.Likes.length}</span> Likes</span>\n    </div>\n    \n    <br><br>\n    <div class="post-comment-form">\n        <form action="/comments/create" method="post" id="comment-form">\n            <textarea name="Content" id="Content" rows=2 cols=25 maxlength=250 required placeholder="Add a comment..."></textarea>\n            <input type="hidden" name="post_id" value=${e._id} >\n            <button type="submit"> Comment </button>\n        </form>\n    </div>\n    <ul>\n    </ul>\n   \n\n        <button class="delete-post" id=${e._id}><a href="/posts/destroy/${e._id}">Delete post</a></button>\n</div>\n`)},deletePost=function(e){$(e).click((function(t){t.preventDefault();let n=$(e).attr("href");$.ajax({method:"GET",url:n,success:function(e){$(".post-box#"+e.post_id).remove(),localStorage.content=$("body").html(),displayFlashMessage(e.flash.success)},error:function(e){console.log(e.responseText)}})}))};$(".delete-post a").toArray().forEach((function(e){deletePost(e)}));let createComment=function(){let e=$("#comment-form");e.submit((function(t){t.preventDefault(),$.ajax({method:"POST",url:"/comments/create",data:e.serialize(),success:function(e){let n=addCommentToDom(e.comment);$(t.target).closest(".post-box").children("ul").prepend(n),deleteComment($(' a[href^="/comments/destroy"]',n)),toggleLike($(" .like",n)),localStorage.content=$("body").html(),displayFlashMessage(e.flash.success)},error:function(e){console.log(e.responseText)}}),$(this).trigger("reset")}))};createComment();let addCommentToDom=function(e){return $(`<li class="comment-box" id=${e._id}>\n     <p>${e.User.Name} --\x3e &nbsp; ${e.Content}</p>&nbsp;&nbsp;<br>\n\n     <div class="like-info">\n        <a href="/likes/toggle/?p_id=${e._id}&p_type=Comment"></a>\n            <i class="far fa-heart like"></i>\n        </a>\n        <span><span class="like-count">${e.Likes.length}</span> Likes</span>\n    </div>\n    <br>\n\n     <button class="delete-comment" id=${e._id} >\n        <a href="/comments/destroy/${e._id}">Delete this comment</a>\n    </button>\n   </li>`)},deleteComment=function(e){$(e).click((function(t){t.preventDefault();let n=$(e).attr("href");$.ajax({method:"GET",url:n,success:function(e){$(".comment-box#"+e.comment_id).remove(),localStorage.content=$("body").html(),displayFlashMessage(e.flash.success)},error:function(e){console.log(e.responseText)}})}))};$(".delete-comment a").toArray().forEach((function(e){deleteComment(e)}));let displayFlashMessage=function(e){e&&new Noty({text:e,type:"success",theme:"relax",timeout:400,animation:{open:"animate__animated animate__headShake",close:"animate__animated animate__headShake"}}).show()},toggleLike=function(e){$(e).click((function(e){e.preventDefault();let t=$(e.target).closest(".like-info").children("a").attr("href");t&&$.ajax({method:"get",url:t,success:function(t){$(e.target).toggleClass("far fas");let n=$(e.target).closest(".like-info").find("span.like-count").html();t.isDeleted?n--:n++,$(e.target).closest(".like-info").find("span.like-count").html(n)},error:function(e){console.log(e.responseText)}})}))},arr=$(".like");for(let e=0;e<arr.length;e++)toggleLike(arr[e]);